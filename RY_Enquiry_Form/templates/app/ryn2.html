{% extends 'layouts/base.html' %}
{% load static %}
{% block title %}Terata Enquiry Workspace {% endblock title %}
<link rel="stylesheet" href="{% static 'style.css' %}">
{% block stylesheets %}
    <!-- <link href="//code.jquery.com/ui/1.11.4/themes/ui-lightness/jquery-ui.css" rel="stylesheet" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script> -->
    <!-- <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js">
    </script> -->
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" rel="stylesheet" />
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"
    rel="stylesheet"> -->
   
    <!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script> -->
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    
    <style>
       
        body {
            margin-top: 20px;
            background-color: #e9ebee;
        }

       
        
        .topright {
            position: absolute;
            top: 20px;
            right: 30px;
            font-size: 18px;    
        }
        .topcenter {
            position: absolute;
            top: 50px;
            right: 610px;
        }
        .popuptext{
            position: fixed;
            top: 60%;
            left: 88%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 300px;
            text-align: center;
            background-color: #f8f5f6;
            opacity: 5;
            padding: 10px;
            z-index: 100;
            display: none;
            /* min-height: 30px;
            min-width: 30px;
            resize: both;
            overflow: auto;
            max-height: fit-content;
            max-width: fit-content; */
        }
        .close-btn {
            position: absolute;
            right: 20px;
            top: 15px;
            background-color: black;
            color: white;
            border-radius: 50%;
            padding: 4px;
        }
        
        .right2 {
            position: absolute;
            left: 150px;
        }

    
    /*  Comment Box CSS */
    @import url(//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css);

    /* .container {
        /* width:240%; 
        margin:15px;
        display: flex;
        padding-bottom: 0px;
    } */

    .detailBox {
        width:970px;
        border:1px solid rgb(204, 167, 167);
        margin-top:40px;
        margin-left: 04%;
        display: flex;
        padding-bottom: 20px;
    }
    .left{
            flex: 50%;
        }
    .right{
        flex: 25%;
    }
   
    .titleBox {
        background-color:#fdfdfd;
        padding:10px;
    }
    .titleBox label{
    color:#444;
    margin:0;
    display:inline-block;
    }

    .commentBox {
        padding:10px;
        border-top:1px dotted rgb(24, 24, 24);
    }
    .commentBox .form-group:first-child, .actionBox .form-group:first-child {
        width:80%;
    }
    .commentBox .form-group:nth-child(2), .actionBox .form-group:nth-child(2) {
        width:18%;
    }
    .actionBox .form-group * {
        width:100%;
    }
    .taskDescription {
        margin-top:10px 0;
        width:100%;
    }
    .commentList {
        padding:0;
        list-style:none;
        max-height:200px;
        overflow:auto;
    }
    .commentList li {
        margin:0;
        margin-top:10px;
    }
    .commentList li > div {
        display:table-cell;
    }
    .commenterImage {
        width:30px;
        margin-right:5px;
        height:100%;
        float:left;
    }
    .commenterImage img {
        width:100%;
        border-radius:50%;
    }
    .commentText p {
        margin:0;
    }
    .sub-text {
        color:#aaa;
        font-family:verdana;
        font-size:11px;
    }
    .actionBox {
        border-top:1px dotted rgb(17, 16, 16);
        padding:10px;
    }
    .userCircle {
            border-radius: 50%;
            background: #289c34;
            border: 1px solid #289c34;
            color: #e6f2ea;
            text-align: center;
            display: block;
            margin: 0px;
            position: relative;
            height: 42px;
            width: 42px;
            z-index: 0;
            font: 32px  Courier New;
        }
    
        .MyTable {
            max-width: 1000px;
            margin: 0 auto;
            height: 100px;
        }

        
        /* scrool Bar menu deisgn */
        div.scrollmenu {
  
             overflow: auto;
            white-space: nowrap;
        }

        div.scrollmenu a {
            display: inline-block;
            color: white;
            text-align: center;
            padding: 14px;
            text-decoration: none;
        }

        div.scrollmenu a:hover {
            background-color: #777;
        }
        div.scroll {
        
        
            height: 150px;
            overflow-x: hidden;
            overflow-y: auto;
            text-align: center;
            padding: 10px;
        }
        .box {
        width:600px;
        margin-top:40px;
        display: flex;
        
    }
    .boxleft{
        margin-left: 20px;    
        flex: 50%;
        }
    .boxright{
        margin-left: 20px;
        flex: 50%;
    }

    </style>
    
    

{% endblock stylesheets %}


<!-- Specific CSS goes HERE -->


{% block content %}

    <!-- <div class="spinner-border not-visible" style="width: 6rem; height: 6rem;" role="status">
        <span class="sr-only"></span>
    </div> -->

        
       <div class="topright" style="margin-top: 20px;"><a href="/logout" id="Logout" class="text-decoration-none"> <span class="userCircle mb-0" data-toggle="tooltip" data-placement="top" title="{{user}}">{{user|make_list|first|capfirst}}</span></a>
        </div>
        <center>
            <h3 style="padding-top: 20px;">Enquiry Workspace </h3>
        </center>
    {% if not Error %}
    <div class="col">
        <div class="text-right">
            <div  class="btn btn-primary" id="showEmailAction" style="margin-top: 40px;"> Raw Message
            </div>
        </div>
        <div class="popuptext" style="border:solid 1px;" id="myPopup">
                <button class='btn btn-danger' style="float: right; cursor: pointer;" id="hidepop"> X </button>
                <center>{{Email_Details}}</center>
        </div>
        <div class="card">
            <div id="collapseTwo" class="collapse show width" data-parent="#accordionHorizontalExample">
                <form name="RYform" id="RYform" action="" method="post">

                    {% csrf_token %}
                    <!-- -->
                    <div class="card text-sm font-weight-bold">
                        <div class="card-header" data-toggle="collapse" data-target="#collapseTwo">
                            {% if vLoggedInRole == 'agent' and vStatus == 0 %}
                            Assign To : 
                            
                            <select class="form-control form-control-sm" id="vGrp_to" name="vGrp_to" disabled style="width: 30%;" required>
                                <option disabled selected value>-- select an group--</option>
                                {% for supplierGrp in supplierGroupNames%}
                                    <option value="{{ supplierGrp }}">{{supplierGrp}}</option>
                                {%endfor%}
                                    
                            </select>
                            {% else %}
                                Enquiry Form : 
                                
                                <input type="text" class="form-control form-control-sm" id="vGrp_to" name="vGrp_to" style="width: 30%;" value="{{GrpAssignedTo}}"readonly>
                                      
                            {% endif %}
                       </div>

                        <div id="collapseTwo" class="collapse show width" data-parent="#accordionHorizontalExample">
                            <div class="card-body">
                                
                                <table>
                                    <tr>
                                        <td><span class="label label-default text-sm font-weight-bold">Reg_No<br>
                                            <input type="text" class="form-control form-control-sm" id="Rno" name="Rno" value={{vReg_no}}
                                            readonly style="width:50px;" >
                                        </span> </td>
                                        <td>
                                            <span class="label label-default text-sm font-weight-bold">Date:<br>
                                                <input type="text" class="form-control form-control-sm" id="Date" name="Date" value='{{Date}}'
                                                    {{Default_Enq_Fileds}} style="width:100px;">
                                            </span>
                                        </td>
                                            
                                        <td> <span class="label label-default text-sm font-weight-bold">Marketing_Zone:<br>
                                            <input type="text" class="form-control form-control-sm" id="Marketing_Zone" name="Marketing_Zone"
                                                value='{{Marketing_Zone}}' {{Default_Enq_Fileds}} style="width:120px;">
                                        </span></td>

                                        <td>
                                            {% if vStatus == 3 and vLoggedInRole == 'supplier' %}
                                            <span class="label label-default text-sm font-weight-bold" style="margin-left:10px;">Ready Stock(Kgs)<br>
                                                <input type="text" class="form-control form-control-sm" id="ReadyStock" name="ReadyStock"
                                                 style="width:150px; margin-left:5px;">
                                            </span>
                                            {% elif vStatus == 4 and vLoggedInRole != 'buyer' %}
                                            <span class="label label-default text-sm font-weight-bold" style="margin-left:10px;">Ready Stock(Kgs)<br>
                                                <input type="text" class="form-control form-control-sm" id="ReadyStock" name="ReadyStock" value="{{vReadyStock}}"
                                                 style="width:150px; margin-left:5px;" readonly>
                                            </span>
                                            {% else %}

                                            {% endif %}
                                        </td>
                                    </tr>
                                    <tr><td colspan="3"><br></td></tr>
                                    <tr>
                                       
                                        <td>
                                            <span class="label label-default text-sm font-weight-bold">Mill:<br>
                                                <input type="text" class="form-control form-control-sm" id="Mill" name="Mill" value='{{Mill}}'
                                                    {{Default_Enq_Fileds}} style="width:250px;">
                                            </span>
                                        </td>
                                   
                                        <td><span class="label label-default text-sm font-weight-bold">Mill_Rep:<br>
                                            <input type="text" class="form-control form-control-sm" id="Mill_Rep" name="Mill_Rep"
                                                value='{{Mill_Rep}}' {{Default_Enq_Fileds}} style="width:250px;">
                                        </span> </td>
                                        <td>
                                            <span class="label label-default text-sm font-weight-bold" style="margin-left:10px;">Customer:<br>
                                                <input type="text" class="form-control form-control-sm" id="Customer" name="Customer"
                                                    value='{{Customer}}' {{Default_Enq_Fileds}} style="width:250px; margin-left:10px;">
                                            </span>
                                        </td>
                                        
                                        <td>
                                            {% if vStatus == 3 and vLoggedInRole == 'supplier' %}
                                            <span class="label label-default text-sm font-weight-bold" style="margin-left:10px;">Delivery Date<br>
                                                <input type="date" class="form-control form-control-sm" id="Delivery_Date" name="Delivery_Date"
                                                 style="width:150px; margin-left:10px;">
                                            </span>
                                            {% elif vStatus == 4 and vLoggedInRole != 'buyer' %}
                                            <span class="label label-default text-sm font-weight-bold" style="margin-left:10px;">Delivery Date<br>
                                                <input type="date" class="form-control form-control-sm" id="Delivery_Date" name="Delivery_Date" value="{{vDelivery_Date}}"
                                                 style="width:150px; margin-left:10px;" readonly>
                                            </span>
                                            {% else %}

                                            {% endif %}
                                        </td>
                                        
                                    </tr>
                                    
                                    
                                </table>
                                
                                <br>
                                <br>
                                
                        <!-- Counts in a table-->
                        {% if vStatus == 0 and vLoggedInRole == 'agent' %}
                        
                        <input type="checkbox" style="margin-left:800px" id="select_all" name="RateFixed" value="RateFixed">&nbsp;Prize Known
                        
                        {% endif %}
                        {% if vStatus == 4 and vLoggedInRole == 'agent' %}
                        
                        <input type="checkbox" style="margin-left:900px" id="select_all" name="ApprovedRate" value="Approved">&nbsp;Prize Fixed
                        
                        {% endif %}
                        <div class="scrollmenu">
                        <table id="MyTable" class="table table-striped table-bordered table-sm " cellspacing="0"
                        width="100%" >

                            <thead>
                                <tr>
                                    <th scope="col">Row_no</th>
                                    <th scope="col"></th>
                                    <th scope="col">Counts</th>
                                    <th scope="col">Quality</th>
                                    <th scope="col">Type</th>
                                    <th scope="col">Blend</th>
                                    <th scope="col">Shade</th>
                                    <th scope="col">Depth</th>
                                    <th scope="col">UOM</th>
                                    <th scope="col">Quantity</th>
                                    {% if vStatus >= 3 %}
                                    <th scope="col">Rate</th>
                                    <!-- <th scope="col">Amount</th> -->
                                    <th scope="col">Last order</th>
                                    {% endif %}

                                </tr>
                            </thead>
                            <tbody>
                            
                            {% for Reg_no in data %}
                                <tr>
                                    <th scope="row">{{forloop.counter}} <input type="hidden"  id="DBID{{forloop.counter}}"
                                        name="DBID{{forloop.counter}}" value="{{Reg_no.id}}" style="width:60px"
                                    ></th>
                                    <th scope="row"></th>

                                    <td><input type="text" class="form-control form-control-sm" id="Counts{{forloop.counter}}"
                                            name="Counts{{forloop.counter}}" value="{{Reg_no.Counts}}" style="width:60px"
                                            {{Default_Enq_Fileds}}>
                                    </td>
                                    <td><input type="text" class="form-control form-control-sm" id="Quality{{forloop.counter}}"
                                            name="Quality{{forloop.counter}}" value="{{Reg_no.Quality}}" style="width:60px"
                                            {{Default_Enq_Fileds}}>
                                    </td>
                                    <td><input type="text" class="form-control form-control-sm" id="YarnType{{forloop.counter}}"
                                            name="YarnType{{forloop.counter}}" value="{{Reg_no.Type}}" style="width:100px"
                                            {{Default_Enq_Fileds}}>
                                    </td>
                                    <td><input type="text" class="form-control form-control-sm" id="Blend{{forloop.counter}}"
                                            name="Blend{{forloop.counter}}" value="{{Reg_no.Blend}}" style="width:250px"
                                            {{Default_Enq_Fileds}}>
                                    </td>
                                    <td><input type="text" class="form-control form-control-sm" id="Shade{{forloop.counter}}"
                                            name="Shade{{forloop.counter}}" value="{{Reg_no.Shade}}" style="width:150px"
                                            {{Default_Enq_Fileds}}>
                                    </td>
                                    <td>
                                        {% if  vLoggedInRole == 'supplier' and vStatus == 4 %} 
                                        <input type="text" class="form-control form-control-sm" id="Depth{{forloop.counter}}"
                                            name="Depth{{forloop.counter}}" value="{{Reg_no.Depth}}" style="width:100px"
                                            >
                                            {% else %}
                                        <input type="text" class="form-control form-control-sm" id="Depth{{forloop.counter}}"
                                            name="Depth{{forloop.counter}}" value="{{Reg_no.Depth}}" style="width:100px"
                                            {{Default_Enq_Fileds}}>
                                            {% endif %}
                                    </td>
                                    <td><input type="text" class="form-control form-control-sm" id="UOM{{forloop.counter}}"
                                            name="UOM{{forloop.counter}}" value="Kgs" style="width:60px"
                                            {{Default_Enq_Fileds}}>
                                    </td>
                                    <td><input type="text" class="form-control form-control-sm" id="Quantity{{forloop.counter}}"
                                            name="Quantity{{forloop.counter}}" value="{{Reg_no.Quantity}}" style="width:80px"
                                            {{Default_Enq_Fileds}}>
                                    </td>
                                    <input type="hidden" name="Shade_rep" value="{{Reg_no.Shade_Ref}}">
                                    {% if vStatus >= 3 %}
                                    
                                    <td>
                                        {% if vLoggedInRole == 'agent' %}
                                        <input type="text" class="form-control form-control-sm" id="Rate{{forloop.counter}}"
                                            name="Rate{{forloop.counter}}" value="{{Reg_no.Supplier_Rate}}" style="width:90px"{{Default_Enq_Fileds}}>
                                        {% elif vLoggedInRole == 'supplier' %}    
                                            <input type="text" class="form-control form-control-sm" id="Rate{{forloop.counter}}"
                                            name="Rate{{forloop.counter}}" value="{{Reg_no.Supplier_Rate}}" style="width:90px">
                                        {% else %}

                                        {% endif %}    
                                        {% if vLoggedInRole != 'supplier' %}
                                                <input type="text" class="form-control form-control-sm" id="Arate{{forloop.counter}}"
                                                name="Arate{{forloop.counter}}" value="{{Reg_no.Agent_Rate}}" style="width:90px" {{Quotation_ready}}>
                                            {% endif %}
                                    </td>
                                    <!-- <td>
                                        {% if vLoggedInRole == 'agent' %}
                                        <input type="text" class="form-control form-control-sm" id="Amount{{forloop.counter}}"
                                            name="Amount{{forloop.counter}}" value="{{Reg_no.Supplier_Amount}}" style="width:150px"{{Default_Enq_Fileds}}>
                                        {% elif vLoggedInRole == 'supplier' %}
                                        <input type="text" class="form-control form-control-sm" id="Amount{{forloop.counter}}"
                                            name="Amount{{forloop.counter}}" value="{{Reg_no.Supplier_Amount}}" style="width:150px" >
                                        {% else %}

                                        {% endif %}
                                            {% if vLoggedInRole != 'supplier' %}
                                            <input type="text" class="form-control form-control-sm" id="Aamount{{forloop.counter}}"
                                            name="Aamount{{forloop.counter}}" value="{{Reg_no.Agent_Amount}}" style="width:150px" {{Quotation_ready}}>
                                            {% endif %}
                                    </td> -->
                                    <td>
                                        <div  class="btn btn-primary" id="ShowDetails" style="margin-top: 10px; margin-left: 30px;"> View
                                        </div>
                                    
                                    <div class="popuptext" style="border:solid 1px;" id="Show">
                                            <button class='btn btn-danger' style="float: right; cursor: pointer;" id="hidepopdetails"> X </button>
                                            {{vMill}}
                                    </div>
                                    
                                        </td>
                                    {% endif %}
                                    

                                </tr>
                                {% endfor %}
                                      
                                <input type="hidden" id="txtRowCount" name="txtRowCount" value="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <br>
                                {% if not Default_Enq_Fileds %}
                                
                                
                                
                                <span class="add-row fa fa-plus-square " style="font-size: x-large; color:#008CBA; margin-left: 80px;" value="Add Row" {{Default_Enq_Fileds}}></span>&nbsp;
                                
                                <span class="delete-row fa fa-minus-square" style="font-size: x-large; color:#008CBA;" value="Delete Row" {{Default_Enq_Fileds}}></span>
                                <small class="text-muted"> Click (+) symbol to ADD Rows (-)  to DELETE rows</small>  
                                {% endif %}
                                
                            </tbody>
                            
                        </table>
                        
                    </div>
                    <div class = "box">
                        <div class="boxright">
                            {% if vStatus == 4  and vLoggedInRole != 'buyer' or vStatus == 5  and vLoggedInRole != 'buyer' %}
                            <p> Total Amount given by Mill <small class="text-muted"> INR  ( Excluding GST)</small> </p>
                            <div class="SupplierRate"> </div>
                            {% endif %}
                        </div>
                        <div class="boxleft">
                            {% if vStatus == 4  and vLoggedInRole != 'supplier' or vStatus == 5  and vLoggedInRole != 'supplier' %}
                            <p> Total Amount given Agent<small class="text-muted"> INR  ( Excluding GST)</small> </p>
                        
                            <div class="txtTotalAmount"> </div>
                        
                            {% endif %}
                        
                        </div>
                        </div>

                        <!-- <input type="text" id="textTotalAmount" readonly>     -->
                    <p></p>
                    
                    <br>{% if vLoggedInRole == 'agent' and vStatus == 4 or vLoggedInRole == 'agent' and vStatus == 0 or vLoggedInRole == 'supplier' and vStatus == 3 %}
                        <small class="text-muted">
                             Please Click on Save only if there is a change
                        </small>
                        

                    <!--
                        Change button size using bootstrap
                    -->
                    <br>

                    
                        <button type="button" class="btn btn-primary" style="width: 20%;" id="saveAndProceed" >save and proceed</button>

                        <!-- <input class="btn btn-primary" style="width: 20%;" id="saveAndProceed" onclick="Verified" value="save and proceed"> -->
                    {% endif %}
                        {% if vStatus == 0 %}
                        <button type="button" class="btn btn-primary" style="width: 20%;" id="cancelAction" >Proceed</button>
                        <!-- <input class="btn btn-primary" style="width: 20%;" id="cancelAction" value=" proceed "> -->
                        {% endif %}
                        {% if vLoggedInRole == 'supplier' and vStatus == 4 %}
                    <br>
                    <small class="text-muted">
                         Please Click on Save only if there is a change
                    </small> <br>
                    <button type="button" class="btn btn-primary" style="width: 20%;" id="UpdateRate">save and proceed</button>
                    
                   
                    {% endif %}
                   <div class="detailBox">
                                    <div class="left">
                                    <div class="titleBox">
                                        <div class="form-group">
                                            <label for="sel1">Comments</label>
                                            <section>
                                                <div class="tab">
                                                    <!-- {% if vLoggedInRole == 'agent' %}
                                                        <input type="button" class="tablinks" value="Internal" id="AgentInternal">
                                                        <input type="button" class="tablinks" value="{{CreatedByUser}}" id="Agent{{CreatedByUser}}">
                                                        <input type="button" class="tablinks" value="{{GrpAssignedTo}}" id="Agent{{GrpAssignedTo}}">
                                                    {% elif vLoggedInRole == 'supplier' %}
                                                        
                                                        <input type="button" class="tablinks" value="{{GrpAssignedTo}}" id="Agent{{GrpAssignedTo}}">
                                                    {% else %}
                                                    <input type="button" class="tablinks" value="Agent" onclick="openTab(event, '1')">

                                                        {% endif %} -->
                                              </button>
                                                
                                                </div>
            
                                                                                                 
                                        </div> 
                                    </div>
                                <div class="actionBox">
                                    <ul class="commentList">
                                        <!-- <div id='1' class="tabcontent">
                                            this is one
                                         </div>
                                         <div id='2' class="tabcontent">
                                            this is two
                                         </div> -->
                                         
                                        {% for id in data3 %} 
                                        <li>
                                            <div class="card bg-light text-dark">
                                                {% if id.CreatedByUser == user %}
                                                <div class="card-body" style="text-align: right; background-color: rgb(220, 215, 215);"> <span class="mb-0">  {{id.Comments}} </span>  -- <span class="date mb-0"> <b>You </b> </span> <span class="date sub-text mb-0">- {{id.DT}}</span> --</div>
                                                {% else %}
                                                <div class="card-body"> <span class="mb-0">  {{id.Comments}} </span>  -- <span class="date mb-0"> <b>{{id.CreatedByUser |capfirst}} </b></span> <span class="date sub-text mb-0"> - {{id.DT}}</span> --</div>
                                                {% endif %}
                                            </div>
               
                                            </li>
                                    {% endfor %}
                                    
                                </section>
                                    </ul>
                                    </div>
                                    </div>
                                    
                                </ul>
                                <!-- <form method="post" class="form-block"> -->
                                    
                                        <div class="right">
                                            

                               
                                            <div class="form-group" style="padding-top: 90px;">
                                            
                                                <center><textarea style="height:250px;width:400px; border: solid rgb(183, 146, 146) 1px; resize: none; background-color: #dadfdc;" 
                                                    class="form-control" required="" id="Ccomment" aria-describedby="emailHelp"
                                                    name="Ccomment" value="" placeholder="Your text"></textarea></center>
                                            </div>
                                            <div id="blur">
                                                <center> <div class="form-group form-check form-check-inline">
                                                    
                                                    {% if vLoggedInRole == 'agent' %}
                                                    <select class="form-control" style="width: 150%;" id="Comments_to" name="GroupName">
                                                        <option disabled selected value> -- select an group-- </option>
                                                        <option value="agent">Internal </option>
                                                        <option value="{{CreatedByUser}}"> {{CreatedByUser}} </option>
                                                        {% if GrpAssignedTo != None %}
                                                        <option value="{{GrpAssignedTo}}"> {{GrpAssignedTo}} </option>
                                                        {% endif %}
                                                    </select> 
                                                    {% elif vLoggedInRole == 'supplier' %}
                                                    <input type="hidden" value="supplier_to_agent" name="GroupName" id="Comments_to">
                                                    <!-- <input type="hidden" value="supplier_to_agent" name="GroupName"> -->
                                                    {% else %}
                                                    <input type="hidden" value="buyer_to_agent" name="GroupName" id="Comments_to">
                                                    {% endif %}
                                                    <button id="commentAction" class="btn btn-default" style="background-color: #85daf7; margin-top: 13px; margin-left: 90px;" >POST Comments</button>
                                                </div>
                                            </center>
                                            </div>
                                            <input type="hidden" id="role" value="{{vLoggedInRole}}">
                                        
                                            <input type="hidden" id="hBtnAction" name="hBtnAction" value="">
                                            {% if messages %}
                                            <div class="alert alert-success alert-dismissible">
                                                {% for message in messages %}
                                                <p>{{ message }}</p>
                                                {% endfor %}
                                            </div>
                                            {% endif %}
                                    <!-- </form> -->
                                    </div>
                        </div>
                        <!-- Ends-->
                    </form>  

                   
                </div>
            </div>
        </div>
   
    
        
    {% else %}
    <br>
    <br>
    <div class="alert alert-danger" role="alert">

        Error UnAuthorized Access
    </div>
    <p class="lead">
        {{Error}}
      </p>
    {% endif %}

{% endblock content %}


{% block javascripts %}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js">
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.2.1/dist/js/bootstrap.min.js"
    integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
    crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script>
    /*document.getElementById("current_date").innerHTML = Date();*/
    $(document).ready(function () {
        var today = new Date();
        var dd = String(today.getDate()).padStart(2, '0');
        var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
        var yyyy = today.getFullYear();

        today = mm + '/' + dd + '/' + yyyy;
        /*document.write(today);*/
        document.getElementById("current_date").innerText = today;
    });
    </script>
    <script>
        $(document).ready(function () {
        var showEmailAction = function () {
        //   alert("hi");
        $('#myPopup').fadeIn(1000);
        $('#myPopup').resizable().draggable();
        $('#hidepop').click(function(){
            $('#myPopup').fadeOut(1000);
            })
        }
        $('#showEmailAction').on('click', showEmailAction)

        var ShowDetails = function () {
        //   alert("hi");
        $('#Show').fadeIn(1000);
        $('#Show').resizable().draggable();
        $('#hidepopdetails').click(function(){
            $('#Show').fadeOut(1000);
            })
        }
        $('#ShowDetails').on('click', ShowDetails)
    });
    
    // console.log("popup")
</script>
<script>
    function onButtonClick() {
        document.getElementById('textInput').className = "show";
        document.getElementById('button').className = "show";
    }
</script>
<script>
    $(document).ready(function () {

        var saveAndProceed = function(){
        var vGroup= $("#vGrp_to").val();
        // var vGroup = $("#vGrp_to option:selected").text()
            console.log(vGroup)
            if(vGroup == null) {
                alert("Please Assign the Group")
            }
            else{
                console.log("vGroup dhinesh")
                $('#hBtnAction').val("sap");
                $('#RYform').submit();
            }
            
        
        }
        $('#saveAndProceed').on('click', saveAndProceed)
        
        var cancelAction = function () {
            var vGroup= $("#vGrp_to").val();
            if(vGroup == null) {
                alert("Please Assign the Group")
            }
            else{
            $('#hBtnAction').val("cancel");
            $('#RYform').submit();
        }
    }
        $('#cancelAction').on('click', cancelAction)

        

        var commentAction = function () {
            var Comments_to = $("#Comments_to").val();
            if(Comments_to == null){
                alert("If you forget who goes to the comment")
            }
            else{
                $('#hBtnAction').val("comment");
                $('#RYform').submit();
                $("#blur").toggle();
            }
            
                
            /*window.location("app/ryn.html")*/
            /*$('#RYform').trigger("reset");
            $(this).closest('#RYform').find("textarea").val("");*/
        }
        $('#commentAction').on('click', commentAction)
        // Supplier Rate fixed to status change 4
        var UpdateRate= function(){ 
                $('#hBtnAction').val("UpdateRate");
                $('#RYform').submit();
            }
        $('#UpdateRate').on('click', UpdateRate)
        //agent Rate fixed to status change 5
        var AgentRate= function(){ 
                $('#hBtnAction').val("UpdateRate");
                $('#RYform').submit();
            }
        $('#UpdateRate').on('click', UpdateRate)

        
        


    });
    if (window.history.replaceState) {
        window.history.replaceState(null, null, window.location.href);
    }

    $(document).keypress(
        function(event){
            if (event.which == '13') {
            event.preventDefault();
            }
        
        
        });
</script>
<script>
    $(document).ready(function () {
        var row_count = $('#MyTable >tbody >tr').length;
        //var row_count = 0;
        // document.getElementById("counting").innerText = row_count;
        //Set total row count of Enquiry Items on load in hidden field
        $("#txtRowCount").val(row_count);
        //calculate total
       
        //alert(" total rows"+row_count);
        var totalAmount = 0;
        
        for ( i = 1;i<=row_count; i++){
            
            var row_rate = parseInt($('#Arate'+i).val());
            var row_quantity = parseInt($('#Quantity'+i).val());

            totalAmount = totalAmount + (row_rate * row_quantity);
            
        }
        
        //  $("#txtTotalAmount").val('totalAmount');
        if (!(isNaN(totalAmount))){
            $("div.txtTotalAmount").text(totalAmount.toLocaleString('en-IN'));    
        }
        
    });
</script>

<script>
    $(document).ready(function () {
        var row_count = $('#MyTable >tbody >tr').length;
        //var row_count = 0;
        // document.getElementById("counting").innerText = row_count;
        //Set total row count of Enquiry Items on load in hidden field
        $("#txtRowCount").val(row_count);
        //calculate total
       
        //alert(" total rows"+row_count);
        var totalAmount = 0;
        
        for ( i = 1;i<=row_count;i++){
            
            var row_rate = parseInt($('#Rate'+i).val());
            var row_quantity = parseInt($('#Quantity'+i).val());

            totalAmount = totalAmount + (row_rate * row_quantity);
            
        }
        if (!(isNaN(totalAmount))){
            
            $("div.SupplierRate").text(totalAmount.toLocaleString('en-IN'));    
        }
        //  $("#txtTotalAmount").val('totalAmount');
        
    });
</script>

<script>
    //initialising a variable name row_count
    var row_count = 0;
    //printing default value of row_count that is 0 in h2 tag
    document.getElementById("counting").innerText = row_count;

    //creation of increment function
    function increment() {
        row_count = row_count + 1;
        // document.getElementById("counting").innerText = row_count;
    }
    //creation of decrement function
    function decrement() {
        row_count = row_count - 1;
        // document.getElementById("counting").innerText = row_count;
    }
</script>
<script>
    $(document).ready(function () {

        var row_count = $('#MyTable >tbody >tr').length;
        //var row_count = 0;
        // document.getElementById("counting").innerText = row_count;
        //Set total row count of Enquiry Items on load in hidden field
        $("#txtRowCount").val(row_count);

        $(".add-row").click(function () {
            row_count = row_count + 1;
            // document.getElementById("counting").innerText = row_count;
            // var Counts = $("#Counts").val();
            // var Quality = $("#Quality").val();
            // var Type = $("#Type").val();
            // var Blend = $("#Blend").val();
            // var Shade = $("#Shade").val();
            // var Depth = $("#Depth").val();
            // var UOM = $("#UOM").val();
            // var Quantity = $("#Quantity").val();
            // var markup = "<tr><td>" + row_count + "</td><td><input type='checkbox' name='record'>" + name + "</td><td><input type='text' class='form-control' >" + Counts + "</td><td><input type='text' class='form-control' >" + Quality + "</td><td><input type='text' class='form-control' >" + Type + "</td><td><input type='text' class='form-control' >" + Blend + "</td><td><input type='text' class='form-control' >" + Shade + "</td><td><input type='text' class='form-control' >" + Depth + "</td><td><input type='text' class='form-control' >" + UOM + "</td><td><input type='text' class='form-control' >" + Quantity + "</td></tr>";
            var markup = "<tr>";
            markup+= "<th scope=\"row\">"+row_count+"</th>";
            markup+= "<td scope=\"row\"><input type='checkbox' name='record'> </td>";
            markup+= "<td><input type=\"text\" class=\"form-control form-control-sm\" id=Counts"+row_count+" name=Counts"+row_count+" style=\"width:60px\" > </td>  ";
            markup+= "<td><input type=\"text\" class=\"form-contro form-control-sml\" id=Quality"+row_count+" name=Quality"+row_count+" style=\"width:60px\" > </td>  ";
            markup+= "<td><input type=\"text\" class=\"form-control form-control-sm\" id=YarnType"+row_count+" name=YarnType"+row_count+" style=\"width:100px\" > </td>  ";
            markup+= "<td><input type=\"text\" class=\"form-control form-control-sm\" id=Blend"+row_count+" name=Blend"+row_count+" style=\"width:250px\" > </td>  ";
            markup+= "<td><input type=\"text\" class=\"form-control form-control-sm\" id=Shade"+row_count+" name=Shade"+row_count+" style=\"width:150px\" > </td>  ";
            markup+= "<td><input type=\"text\" class=\"form-control form-control-sm\" id=Depth"+row_count+" name=Depth"+row_count+" style=\"width:100px\" > </td>  ";
            markup+= "<td><input type=\"text\" class=\"form-control form-control-sm\" id=UOM"+row_count+" name=UOM"+row_count+" style=\"width:60px\" > </td>  ";
            markup+= "<td><input type=\"text\" class=\"form-control form-control-sm\" id=Quantity"+row_count+" name=Quantity"+row_count+" style=\"width:80px\" > </td>  ";  
            markup+= "</tr>";
            $("#MyTable").append(markup);
            $("#txtRowCount").val(row_count);
        });

        // Find and remove selected table rows
        $(".delete-row").click(function () {
            $("#MyTable").find('input[name="record"]').each(function () {
                if ($(this).is(":checked")) {
                    $(this).parents("tr").remove();
                    row_count = row_count - 1;
                    // document.getElementById("counting").innerText = row_count;
                }
            });
            $("#txtRowCount").val(row_count);
        });
    });
    $('#myModal').on('shown.bs.modal', function () {
        $('#myInput').trigger('focus')
    })   
</script>
<script type="text/javascript">
    $(document).ready(function () {

        $('#wrapper').dialog({
            autoOpen: false,
            title: 'Email Details'
        });
        $('#opener').click(function () {
            $('#wrapper').dialog('open');
            // return false;
        });
    });
</script>
<script type="text/javascript"> 
    $(document).ready(function () {
        var a = "{{ vStatus }}";
        if (a=='0'){
            $('#vGrp_to').removeAttr('disabled')
        }
    });
   
     </script>
    
{% endblock javascripts %}